<script type="text/javascript">
  function randomize(str) {
    str = str.split('');
    for (i = 0; i < 10; i++) {
      str = str.reverse().sort(randomSort);
    }
    return str.join('');
  }

  function randomSort(a, b) {
    return( parseInt( Math.random()*500 ) %2 );
  }
  
  function passGen(params) {
    var letters = '';
    letters += 'abcdefghijklmnopqrstuvwxyz';
    letters += params.allowUppercase ? 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' : '';
    var numbers = '0123456789';
    var chars = '!@#$%^&*?+';
    var output = '';
    var size = params.size - params.specialchars - params.numbers;

    for (i = 0; i < params.specialchars; i++) {
      rand = Math.floor(Math.random() * chars.length);
      output += chars[rand];
    }
    for (i = 0; i < params.numbers; i++) {
      rand = Math.floor(Math.random() * chars.length);
      output += numbers[rand];
    }
    for (i = 0; i < size; i++) {
      rand = Math.floor(Math.random() * letters.length);
      output += letters[rand];
    }
    return randomize(output);
  }

  function passGenReplace() {
    $('#passgen-placeholder-inner pre').text(
      passGen({
        size: $('#passgen-size').val(),
        numbers: $('#passgen-numbers').val(),
        specialchars: $('#passgen-specialchar').val(),
        allowUppercase: $('#passgen-allow-uppercase').attr('checked')
      })
    );
  }

  $(document).ready(function() {
    passGenReplace();
    $('#passgen-generate').click(function() {
      passGenReplace();
    });
  });
</script>

<div class="passgen-container">
  <div id="passgen-placeholder">
    <div id="passgen-placeholder-inner"><pre></pre></div>
  </div>

  <div class="group">
    <label for="passgen-size">Length</label>
    <input type="number" id="passgen-size" value="15" />
  </div>

  <div class="group">
    <label for="passgen-numbers">Numbers</label>
    <input type="number" id="passgen-numbers" value="3" />
  </div>

  <div class="group">
    <label for="passgen-specialchar">Special Characters</label>
    <input type="number" id="passgen-specialchar" value="3" />
  </div>

  <div class="group">
    <label for="passgen-allow-uppercase">Allow uppercase?</label>
    <input type="checkbox" id="passgen-allow-uppercase" checked="yes" />
  </div>

  <div class="group">
    <button type="button" id="passgen-generate">Regenerate</button>
  </div>
</div>
